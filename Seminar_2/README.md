Контейнеризация.

 Урок 2.Механизмы контрольных групп

Задание 1:
1) запустить контейнер с ubuntu, используя механизм LXC
2) ограничить контейнер 256 Мб ОЗУ и проверить, что ограничение работает.

СПОСОБ 1. Команды к семинару 2.

apt-get install lxc debootstrap bridge-utils lxc-templates
apt-get install lxd-installer
lxd init(Здесь просто нажимаем на Enter что уствновились значения по умолчанию)
Проверяем
lxc storage list
lxc storage list
И создаем контейнер
lxc-create -n test01 -t ubuntu -f /usr/share/doc/lxc/example/lxc-veth.conf

![Скриншот](/Seminar_2/image1.jpg)

![Скриншот](/Seminar_2/image2.jpg)

![Скриншот](/Seminar_2/image3.jpg)

![Скриншот](/Seminar_2/image4.jpg)

Никаких изменений , к сожалению, мы не увидели...

Всемирная паутина выдала следующую информацию:
"lxc.cgroup.memory.limit_in_bytes = 512M. После перезагрузки контейнера, ему будет доступно, максимум 512 Мб памяти. Но, даже установив этот лимит, команда free -m выполненная в контейнере будет все так же выводить информацию о памяти хоста." Источник https://ivirt-it.ru/lxc-linux-containers-resources-limitation/

![Скриншот](/Seminar_2/image5.jpg)

Отсюда следует СПОСОБ 2.
Создадим другой контейнер, чтобы не путаться.

Команды: 

lxc-create -t ubuntu -n test1

Запускаем контейнер и входим в него:

lxc-start -n test1
lxc-attach -n test1

проверяем память
free -m

и выходим exit

ограничиваем память в конфигурационном файле

nano/var/lib/test1/config

останавливаем контейнер и перезапускаем его

lxc-stop -n test1
lxc-start -n test1
lxc-attach -n test1
free -m
![Скриншот](/Seminar_2/image6.jpg)



И ВИДИМ, ЧТО НАШЕ ОГРАНИЧЕНИЕ РАБОТАЕТ!
![Скриншот](/Seminar_2/image7.jpg)

ВОЗВРАЩАЕМСЯ В СПОСОБ 1 и ПРОБУЕМ РАЗОБРАТЬСЯ и проводим такие же манипуляции, видим, что наше ограничение действительно работает. 

ПРИЧИНА ПЕРВОЙ НЕУДАЧНОЙ ПОПЫТКИ оказалась в том, что сначала работаем в конфигурационном файле, а потом уже закрываем контейнер и снова его запускаем.

![Скриншот](/Seminar_2/image8.jpg)